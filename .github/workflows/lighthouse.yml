name: Lighthouse CI - Mobile & Desktop
on: 
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  lighthouse-mobile:
    name: Lighthouse Mobile
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: Run Lighthouse CI - Mobile
        id: lighthouse-mobile
        uses: treosh/lighthouse-ci-action@v12
        with:
          urls: |
            https://dhaneshbb.github.io
            https://dhaneshbb.github.io/about.html
            https://dhaneshbb.github.io/projects.html
            https://dhaneshbb.github.io/experience.html
            https://dhaneshbb.github.io/contact.html
          uploadArtifacts: true
          temporaryPublicStorage: true
          runs: 3
          configPath: './lighthouserc-mobile.json'
          
      - name: Print Mobile Report Links
        run: |
          echo "üîó MOBILE LIGHTHOUSE REPORT LINKS"
          echo "=================================="
          echo ""
          echo "üì± HOME PAGE (MOBILE):"
          echo "${{ fromJSON(steps.lighthouse-mobile.outputs.links)[0] }}"
          echo ""
          echo "üì± ABOUT PAGE (MOBILE):"
          echo "${{ fromJSON(steps.lighthouse-mobile.outputs.links)[1] }}"
          echo ""
          echo "üì± PROJECTS PAGE (MOBILE):"
          echo "${{ fromJSON(steps.lighthouse-mobile.outputs.links)[2] }}"
          echo ""
          echo "üì± EXPERIENCE PAGE (MOBILE):"
          echo "${{ fromJSON(steps.lighthouse-mobile.outputs.links)[3] }}"
          echo ""
          echo "üì± CONTACT PAGE (MOBILE):"
          echo "${{ fromJSON(steps.lighthouse-mobile.outputs.links)[4] }}"
          echo ""
          echo "=================================="

  lighthouse-desktop:
    name: Lighthouse Desktop
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: Run Lighthouse CI - Desktop
        id: lighthouse-desktop
        uses: treosh/lighthouse-ci-action@v12
        with:
          urls: |
            https://dhaneshbb.github.io
            https://dhaneshbb.github.io/about.html
            https://dhaneshbb.github.io/projects.html
            https://dhaneshbb.github.io/experience.html
            https://dhaneshbb.github.io/contact.html
          uploadArtifacts: true
          temporaryPublicStorage: true
          runs: 3
          configPath: './lighthouserc-desktop.json'
          
      - name: Print Desktop Report Links
        run: |
          echo "üîó DESKTOP LIGHTHOUSE REPORT LINKS"
          echo "==================================="

  print-all-links:
    name: üìã All Report Links Summary
    runs-on: ubuntu-latest
    needs: [lighthouse-mobile, lighthouse-desktop]
    if: always()
    steps:
      - name: Print Complete Report Summary
        run: |
          echo "üéØ COMPLETE LIGHTHOUSE REPORTS SUMMARY"
          echo "======================================="
          echo ""
          echo "‚úÖ All reports generated successfully!"
          echo ""
          echo "üì± MOBILE REPORTS:"
          echo "üè† Home:       https://googlechrome.github.io/lighthouse/viewer/?psi=YOUR_MOBILE_HOME_LINK"
          echo "üë§ About:      https://googlechrome.github.io/lighthouse/viewer/?psi=YOUR_MOBILE_ABOUT_LINK"
          echo "üöÄ Projects:   https://googlechrome.github.io/lighthouse/viewer/?psi=YOUR_MOBILE_PROJECTS_LINK"
          echo "üíº Experience: https://googlechrome.github.io/lighthouse/viewer/?psi=YOUR_MOBILE_EXPERIENCE_LINK"
          echo "üìû Contact:    https://googlechrome.github.io/lighthouse/viewer/?psi=YOUR_MOBILE_CONTACT_LINK"
          echo ""
          echo "üíª DESKTOP REPORTS:"
          echo "üè† Home:       https://googlechrome.github.io/lighthouse/viewer/?psi=YOUR_DESKTOP_HOME_LINK"
          echo "üë§ About:      https://googlechrome.github.io/lighthouse/viewer/?psi=YOUR_DESKTOP_ABOUT_LINK"
          echo "üöÄ Projects:   https://googlechrome.github.io/lighthouse/viewer/?psi=YOUR_DESKTOP_PROJECTS_LINK"
          echo "üíº Experience: https://googlechrome.github.io/lighthouse/viewer/?psi=YOUR_DESKTOP_EXPERIENCE_LINK"
          echo "üìû Contact:    https://googlechrome.github.io/lighthouse/viewer/?psi=YOUR_DESKTOP_CONTACT_LINK"
          echo ""
          echo "üîó DIRECT LINKS (Check individual job logs above for actual URLs)"
          echo ""
          echo "üìä PERFORMANCE COMPARISON:"
          echo "Compare mobile vs desktop scores to see device-specific optimizations needed"
          echo ""
          echo "‚¨áÔ∏è ARTIFACTS:"
          echo "Download detailed HTML reports from the Artifacts section"
          echo ""
          echo "======================================="
          echo ""
          echo "üíª HOME PAGE (DESKTOP):"
          echo "${{ fromJSON(steps.lighthouse-desktop.outputs.links)[0] }}"
          echo ""
          echo "üíª ABOUT PAGE (DESKTOP):"
          echo "${{ fromJSON(steps.lighthouse-desktop.outputs.links)[1] }}"
          echo ""
          echo "üíª PROJECTS PAGE (DESKTOP):"
          echo "${{ fromJSON(steps.lighthouse-desktop.outputs.links)[2] }}"
          echo ""
          echo "üíª EXPERIENCE PAGE (DESKTOP):"
          echo "${{ fromJSON(steps.lighthouse-desktop.outputs.links)[3] }}"
          echo ""
          echo "üíª CONTACT PAGE (DESKTOP):"
          echo "${{ fromJSON(steps.lighthouse-desktop.outputs.links)[4] }}"
          echo ""
          echo "==================================="